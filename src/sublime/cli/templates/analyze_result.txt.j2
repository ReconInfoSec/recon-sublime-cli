╔═══════════════════════════╗
║ <header>{{ "{:^25}".format("Results") }}</header> ║
╚═══════════════════════════╝

{%- if flagged_messages|length > 0 %}
    {% set msg = flagged_messages[0] %}
{%- else %}
    {% set msg = unflagged_messages[0] %}
{%- endif %}

<header>SUMMARY</header>
==================
<key>File Name</key>: <green>{{msg.file_name}}</green>
<key>Directory</key>: <green>{{msg.directory}}</green>

<key>Total Rules</key>: <green>{{stats.total_rules}}</green>
<key>Total Queries</key>: <green>{{stats.total_queries}}</green>
<key>Rules Flagged</key>: <green>{{stats.flagged_rules}}</green>

{%- if msg.flagged_rule_results|length > 0 %}
{# new line #}
<bold>RULES FLAGGED</bold>
{%- for rule in msg.flagged_rule_results %}
  - <detected><bold>{{ rule.name }}</bold> flagged this message.</detected>
    {%- if verbose %}
    <key>Source:</key> {{ rule.source }}
    {{ "" }}
  {%- endif %}
{# new line #}
{%- endfor %}
{%- endif %}

{%- if msg.unflagged_rule_results|length > 0 %}
{# new line #}
<bold>RULES NOT FLAGGED</bold>
{%- for rule in msg.unflagged_rule_results %}
  {%- if rule.success %}
  - <detected><bold>{{ rule.name }}</bold> did not flag.</detected>
    {%- if verbose %}
    <key>Source:</key> {{ rule.source }}
    {{ "" }}
    {%- endif %}
  {%- else %}
  - <fail><bold>{{ rule.name }}</bold> failed to run.</fail>
  {%- endif %}
{# new line #}
{%- endfor %}
{%- endif %}

{%- if msg.query_results|length > 0 %}
{# new line #}
<bold>QUERIES</bold>
{%- for query in msg.query_results %}
  {%- if query.success %}
  - <detected><bold>{{ query.name }}</bold></detected>
    <key>Result:</key> {{ query.result }}
    {%- if verbose %}
    <key>Source:</key> {{ query.source }}
    {{ "" }}
    {%- endif %}
  {%- else %}
  - <fail><bold>{{ query.name }}</bold> failed to run.</fail>
  {%- endif %}
{# new line #}
{%- endfor %}
{%- endif %}